<!-- Left Wallet panel ==== -->
<div class="wallets-panel">
     <!-- Header with title + Generate button -->
     <h2 class="panel-title">
          <lucide-icon name="wallet" size="25" style="padding-top: 5px"></lucide-icon>
          Accounts
          <button class="generate-btn" (click)="generateNewAccount()">+ Generate</button>
     </h2>

     <p class="panel-subtitle">Generate {{environment}} accounts with XRP from the faucet. You can also generate or derive accounts in the 'Wallets' Menu.</p>

     @if (hasWallets) {
     <div>
          <div cdkDropList (cdkDropListDropped)="dropWallet($event)">
               @for (wallet of wallets; track wallet.address; let i = $index) {
               <div class="wallet-item" cdkDrag [class.selected]="selectedWalletIndex === i">
                    <!-- Wallet Info -->
                    <div class="wallet-info">
                         @if (editingIndex(i)) {
                         <input #nameInput [(ngModel)]="tempName" (blur)="saveName()" (keyup.enter)="saveName()" (keyup.escape)="cancelEdit()" class="name-input" placeholder="Enter name" (click)="$event.stopPropagation()" />
                         } @else {
                         <span (click)="editName(i); $event.stopPropagation()" class="clickable-name"> {{ wallet.name || 'Wallet ' + (i + 1) }} </span>
                         }
                    </div>

                    <div class="wallet-info" (click)="selectWallet(i)">
                         <div class="address-line">
                              <div class="wallet-address">{{ wallet.address | slice:0:7 }}...{{ wallet.address | slice:-7 }}</div>
                              <div class="wallet-balance">{{ wallet.balance || 0 | number:'1.2-2' }} XRP</div>
                         </div>

                         <!-- Icons -->
                         <div class="wallet-actions">
                              <button class="icon-btn refresh" (click)="refreshBalance(i); $event.stopPropagation()" title="Refresh Balance">
                                   <lucide-icon name="refresh-ccw"></lucide-icon>
                              </button>
                              <button class="icon-btn copy" (click)="copyUtilService.copyAddress(wallet.address); $event.stopPropagation()" title="Copy Address">
                                   <lucide-icon name="copy"></lucide-icon>
                              </button>
                              <button class="icon-btn delete" (click)="deleteWallet(i); $event.stopPropagation()" title="Delete Wallet">
                                   <lucide-icon name="trash-2"></lucide-icon>
                              </button>
                         </div>
                    </div>

                    <!-- Secret Key -->
                    <div class="secret-section" (click)="selectWallet(i)">
                         <button class="show-toggle" (click)="toggleSecret(i); $event.stopPropagation()">
                              <lucide-icon [name]="wallet.showSecret ? 'eye-off' : 'eye'" size="16" style="padding-top: 5px"></lucide-icon>
                              <span>{{ wallet.showSecret ? 'Hide Secret' : 'Show Secret' }}</span>
                         </button>

                         @if (wallet.showSecret) {
                         <div class="secret-seed-container">
                              <div class="secret-seed">{{ wallet.seed }}</div>
                              <button class="copy-btn" (click)="copyUtilService.copySeed(wallet.seed); $event.stopPropagation()" title="Copy seed">
                                   <lucide-icon name="copy" size="20"></lucide-icon>
                              </button>
                         </div>
                         }
                    </div>
               </div>
               }
          </div>

          <!-- Selected Account Summary -->
          <div class="selected-account-card">
               <div class="wallet-address" style="padding-bottom: 0.5em">Selected Account</div>
               <div class="summary-row"><span>Address:</span> <span>{{ currentWallet.address | slice:0:7 }}...{{ currentWallet.address | slice:-7 }}</span></div>
               <div class="summary-row"><span>Balance:</span> <span class="highlight wallet-balance">{{ currentWallet.balance }} XRP</span></div>
               <div class="summary-row"><span>Owner Count:</span> <span class="highlight wallet-balance">{{ currentWallet.ownerCount }}</span></div>
               <div class="summary-row"><span>Xrp Reserves:</span> <span class="highlight wallet-balance">{{ currentWallet.xrpReserves }} XRP</span></div>
          </div>
     </div>
     } @else {
     <div class="no-wallet-found">
          <lucide-icon name="wallet" size="40"></lucide-icon>
          <p>No accounts generated yet.</p>
          <p>Click "Generate" to create your first {{environment}} account</p>
     </div>
     }
</div>

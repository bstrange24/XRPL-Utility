<div class="banner">
     <div class="banner-content">
          <div id="navbar-container">
               <app-navbar></app-navbar>
          </div>
     </div>
</div>

<!-- Main content. Centered with 2 columns -->
<div class="main-container">
     <div class="content-wrapper">
          <!-- Left Wallet panel ==== -->
          <app-wallet-panel (walletSelected)="onWalletSelected($event)"></app-wallet-panel>

          <div class="toast" [class.show]="ui.showToast">{{ ui.toastMessage }}</div>

          <!-- Right form -->
          <div class="form-panel">
               <!-- Menu bar -->
               <div class="menu-bar">
                    <button class="menu-btn" [class.active]="activeTab === 'getOffers'" (click)="setTab('getOffers')">
                         <ng-icon name="heroCurrencyDollar" size="20" class="text-red-600"></ng-icon>
                         Offers
                    </button>
                    <!-- <button class="menu-btn" [class.active]="activeTab === 'getOrderBook'" (click)="setTab('getOrderBook')">
                         <ng-icon name="heroCurrencyDollar" size="20" class="text-red-600"></ng-icon>
                         Get Order Book
                    </button>
                    <button class="menu-btn" [class.active]="activeTab === 'createOffer'" (click)="setTab('createOffer')">
                         <ng-icon name="heroCurrencyDollar" size="20" class="text-red-600"></ng-icon>
                         Create Offer
                    </button> -->
                    <button class="menu-btn" [class.active]="activeTab === 'cancelOffer'" (click)="setTab('cancelOffer')">
                         <ng-icon name="heroArrowPath" size="20" class="text-red-600"></ng-icon>
                         Cancel Offer
                    </button>
               </div>

               <!-- Get Offer Menu -->
               @if (activeTab === 'getOffers') {
               <div>
                    <div class="submenu-info-text">
                         <div class="blue-button-submenu">
                              <ng-icon name="heroCurrencyDollar" size="27" class="text-red-600"></ng-icon>
                         </div>
                         <div>
                              <h2 class="submenu-info-main-text">Offers</h2>
                              <p class="submenu-info-secondary-text">Get existing offers, orderbooks and create offers on the XRPL DEX.</p>
                         </div>
                    </div>
               </div>
               }

               <!-- Get OrderBook Menu -->
               <!-- @if (activeTab === 'getOrderBook') {
               <div>
                    <div class="submenu-info-text">
                         <div class="blue-button-submenu">
                              <ng-icon name="heroCurrencyDollar" size="27" class="text-red-600"></ng-icon>
                         </div>
                         <div>
                              <h2 class="submenu-info-main-text">Get Order Book</h2>
                              <p class="submenu-info-secondary-text">Get order book on the XRPL Dex for the currency pair.</p>
                         </div>
                    </div>
               </div>
               } -->

               <!-- Create Offer Menu -->
               <!-- @if (activeTab === 'createOffer') {
               <div>
                    <div class="submenu-info-text">
                         <div class="blue-button-submenu">
                              <ng-icon name="heroCurrencyDollar" size="27" class="text-red-600"></ng-icon>
                         </div>
                         <div>
                              <h2 class="submenu-info-main-text">Create Offer</h2>
                              <p class="submenu-info-secondary-text">Create Offer on the XRPL DEX.</p>
                         </div>
                    </div>
               </div>
               } -->

               <!-- Cancel Offer Menu -->
               @if (activeTab === 'cancelOffer') {
               <div>
                    <div class="submenu-info-text">
                         <div class="red-button-submenu">
                              <ng-icon name="heroTrash" size="27" class="text-red-600"></ng-icon>
                         </div>
                         <div>
                              <h2 class="submenu-info-main-text">Cancel Offer</h2>
                              <p class="submenu-info-secondary-text">Cancel offer on the XRPL DEX.</p>
                         </div>
                    </div>
               </div>
               }

               <!-- Dynamic info panel -->
               @if (ui.infoMessage) {
               <div class="info-panel">
                    <ng-icon name="heroInformationCircle" size="20" class="text-blue-600"></ng-icon>
                    <div class="info-text" [innerHTML]="ui.safeInfo"></div>
               </div>
               }

               <!-- Warning Message -->
               @if (ui.warningMessage) {
               <div class="warning-panel">
                    <ng-icon name="heroExclamationTriangle" size="20" class="text-yellow-600"></ng-icon>
                    <div class="warning-text" [innerHTML]="ui.safeWarning"></div>
               </div>
               }

               <!-- Existing NFTs on selected account -->
               <!-- @if (existingNfts.length > 0) {
               <div class="outstanding-checks-panel">
                    <div class="panel-header" (click)="toggleExistingNfts()" style="cursor: pointer; user-select: none">
                         <h3 class="panel-title" style="margin: 0; font-size: 0.8rem; display: flex; align-items: center; gap: 0.5rem">
                              <ng-icon name="heroQueueList" size="20" class="text-red-600"></ng-icon>
                              Existing NFTs ({{ existingNfts.length }})
                         </h3>
                    </div>

                    <div class="checks-list-container" [style.max-height]="existingNftsCollapsed ? '0': (existingNfts.length * 80 + 20) + 'px'" [style.overflow]="'hidden'" [style.transition]="'max-height 0.3s ease'">
                         @if (!existingNftsCollapsed) {
                         <div class="checks-list">
                              @for (chk of existingNfts; track chk.NFTokenID) {
                              <div class="check-card">
                                   <div class="check-extras">
                                        @if (chk.LedgerEntryType) {
                                        <span class="badge badge-expire"> LedgerEntryType: {{ chk.LedgerEntryType }} </span>
                                        } @else {
                                        <span class="badge badge-expire-not-set"> LedgerEntryType: Not set </span>
                                        } @if (chk.NFTokenID) {
                                        <span class="badge badge-expire"> NFTokenID: {{ chk.NFTokenID }} </span>
                                        } @else {
                                        <span class="badge badge-expire-not-set"> NFTokenID: Not set </span>
                                        } @if (chk.Flags !== undefined && chk.Flags !== 0) {
                                        <span class="badge badge-expire">
                                             Flags: @for (f of decodeNftFlags(chk.Flags); track f) {
                                             <span class="flag-item">{{ f }}</span>
                                             }
                                             <span class="flag-original">({{ chk.Flags }})</span>
                                        </span>
                                        } @else {
                                        <span class="badge badge-expire-not-set"> Flags: Not set </span>
                                        }

                                        <div class="line-break"></div>

                                        @if (chk.URI) {
                                        <span class="badge badge-tag"> URI: {{ chk.URI }} </span>
                                        } @else {
                                        <span class="badge badge-tag-not-set"> URI: Not set </span>
                                        }
                                   </div>

                                   <div class="button-group">
                                        <button class="icon-btn copy-check-id" (click)="copyNFTokenID(chk.NFTokenID); $event.stopPropagation(); $event.preventDefault()" title="Copy NFT Token ID" type="button">
                                             <ng-icon name="heroClipboardDocumentList" size="20" class="text-red-600"></ng-icon>
                                             <a [href]="`${url}account/` + currentWallet.address + `/nfts`" target="_blank" rel="noopener noreferrer" class="icon-btn" style="padding-left: 20px" title="View on XRPL Win" (click)="$event.stopPropagation()">
                                                  <ng-icon name="heroArrowTopRightOnSquare" size="20" class="text-blue-600"></ng-icon>
                                             </a>
                                        </button>
                                   </div>
                              </div>
                              }
                         </div>
                         }
                    </div>
               </div>
               } -->

               <!-- Existing Sell offers on selected account -->
               @if (existingSellOffers.length > 0) {
               <div class="outstanding-checks-panel">
                    <div class="panel-header" (click)="toggleExistingSellOffers()" style="cursor: pointer; user-select: none">
                         <h3 class="panel-title" style="margin: 0; font-size: 0.8rem; display: flex; align-items: center; gap: 0.5rem">
                              <ng-icon name="heroQueueList" size="20" class="text-red-600"></ng-icon>
                              Existing Sell Offers ({{ existingSellOffers.length }})
                         </h3>
                    </div>

                    <div class="checks-list-container" [style.max-height]="existingSellOffersCollapsed ? '0': (existingSellOffers.length * 80 + 20) + 'px'" [style.overflow]="'hidden'" [style.transition]="'max-height 0.3s ease'">
                         @if (!existingSellOffersCollapsed) {
                         <div class="checks-list">
                              @for (offer of existingSellOffers; track offer.OfferIndex) {
                              <div class="check-card">
                                   <div class="check-extras">
                                        @if (offer.LedgerEntryType) {
                                        <span class="badge badge-expire"> LedgerEntryType: {{ offer.LedgerEntryType }} </span>
                                        } @else {
                                        <span class="badge badge-expire-not-set"> LedgerEntryType: Not set </span>
                                        } @if (offer.NFTokenID) {
                                        <span class="badge badge-expire"> NFTokenID: {{ offer.NFTokenID }} </span>
                                        } @else {
                                        <span class="badge badge-expire-not-set"> NFTokenID: Not set </span>
                                        } @if (offer.Flags !== undefined && offer.Flags !== 0) {
                                        <!-- <span class="badge badge-expire">
                                             Flags: @for (f of decodeOfferFlags(offer.Flags); track f) {
                                             <span>{{ f }}</span>
                                             }
                                             <span class="flag-original"> ({{ offer.Flags }})</span>
                                        </span> -->
                                        } @else {
                                        <span class="badge badge-expire-not-set"> Flags: Not set </span>
                                        }

                                        <div class="line-break"></div>

                                        @if (offer.IsSellOffer) {
                                        <span class="badge badge-tag"> Is Sell Offer: {{ offer.IsSellOffer }} </span>
                                        } @else {
                                        <span class="badge badge-tag-not-set"> Is Sell Offer: Not set </span>
                                        } @if (offer.OfferIndex) {
                                        <span class="badge badge-tag"> Offer Index: {{ offer.OfferIndex }} </span>
                                        } @else {
                                        <span class="badge badge-tag-not-set"> Offer Index: Not set </span>
                                        } @if (offer.AmountXRP) {
                                        <span class="badge badge-tag"> Amount: {{ offer.AmountXRP }} XRP</span>
                                        } @else {
                                        <span class="badge badge-tag-not-set"> XRP Amount: Not set </span>
                                        } @if (offer.Owner) {
                                        <span class="badge badge-tag"> Owner: {{ offer.Owner }}</span>
                                        } @else {
                                        <span class="badge badge-tag-not-set"> Owner: Not set </span>
                                        }
                                   </div>

                                   <!-- <div class="button-group">
                                        <button class="icon-btn copy-check-id" (click)="copyNFTokenID(offer.NFTokenID); $event.stopPropagation(); $event.preventDefault()" title="Copy NFT Token ID" type="button">
                                             <ng-icon name="heroClipboardDocumentList" size="20" class="text-red-600"></ng-icon>
                                             <a [href]="`${url}account/` + currentWallet.address + `/nfts`" target="_blank" rel="noopener noreferrer" class="icon-btn" style="padding-left: 20px" title="View on XRPL Win" (click)="$event.stopPropagation()">
                                                  <ng-icon name="heroArrowTopRightOnSquare" size="20" class="text-blue-600"></ng-icon>
                                             </a>
                                        </button>
                                   </div> -->
                              </div>
                              }
                         </div>
                         }
                    </div>
               </div>
               }

               <form #theForm="ngForm" class="send-form">
                    <div [@tabTransition]="activeTab">
                         <div class="tab-content-columns">
                              <!-- ==================== LEFT: FORM FIELDS ==================== -->
                              <div class="tab-content-container form-fields-container">
                                   <!-- Get Offers -->
                                   @if(activeTab === 'getOffers') {
                                   <div class="form-row">
                                        <!-- Info -->
                                        <div class="form-group">
                                             <span class="tooltip" tooltip-data="Taker Gets.">
                                                  <label for="weWantCurrencyField">Taker Gets - I'm buying (weWant)</label>
                                             </span>
                                        </div>
                                        <div class="form-group">
                                             <span class="tooltip" tooltip-data="Taker Pays.">
                                                  <label for="weSpendCurrencyField">Taker Pays - I'm selling (weSpend)</label>
                                             </span>
                                        </div>
                                   </div>

                                   <div class="form-row">
                                        <!-- Currency Code -->
                                        <div class="form-group">
                                             <label>Currency Code</label>
                                             <select id="weWantCurrencyField" [(ngModel)]="weWantCurrencyField" (ngModelChange)="onCurrencyChange($event)" name="weWantCurrencyField">
                                                  @for (curr of currencies; track curr) {
                                                  <option [value]="curr">{{ curr }}</option>
                                                  }
                                             </select>
                                        </div>
                                        <div class="form-group">
                                             <label>Currency Code</label>
                                             <select id="weSpendCurrencyField" [(ngModel)]="weSpendCurrencyField" (ngModelChange)="onCurrencyChange($event)" name="weSpendCurrencyField">
                                                  @for (curr of currencies; track curr) {
                                                  <option [value]="curr">{{ curr }}</option>
                                                  }
                                             </select>
                                        </div>
                                   </div>

                                   <div class="form-row">
                                        <!-- Issuer -->
                                        <div class="form-group">
                                             <label>Issuer</label>
                                             <select id="weWantIssuerField" [(ngModel)]="weWantIssuerField" (ngModelChange)="onIssuerChange($event)" name="weWantIssuerField">
                                                  @for (iss of issuers; track iss.address) {
                                                  <option [value]="iss.address">{{ iss.name }} ({{ iss.address | slice:0:8 }}...{{ iss.address | slice:-6 }})</option>
                                                  }
                                             </select>
                                        </div>
                                        <div class="form-group">
                                             <label>Issuer</label>
                                             <select id="weSpendIssuerField" [(ngModel)]="weSpendIssuerField" (ngModelChange)="onIssuerChange($event)" name="weSpendIssuerField">
                                                  @for (iss of issuers; track iss.address) {
                                                  <option [value]="iss.address">{{ iss.name }} ({{ iss.address | slice:0:8 }}...{{ iss.address | slice:-6 }})</option>
                                                  }
                                             </select>
                                        </div>
                                   </div>

                                   <div class="form-row">
                                        <!-- Amount -->
                                        <div class="form-group">
                                             <label>Amount</label>
                                             <input type="text" [(ngModel)]="weWantAmountField" name="weWantAmountField" placeholder="e.g. 10.5" />
                                        </div>
                                        <div class="form-group">
                                             <label>Amount</label>
                                             <input type="text" [(ngModel)]="weSpendAmountField" name="weSpendAmountField" placeholder="e.g. 10.5" />
                                        </div>
                                   </div>

                                   <div class="form-row">
                                        <!-- Currency Balance -->
                                        <div class="form-group">
                                             <label>Currency Balance</label>
                                             <input type="text" [(ngModel)]="weWantTokenBalanceField" name="weWantTokenBalanceField" readonly placeholder="" />
                                        </div>
                                        <div class="form-group">
                                             <label>Currency Balance</label>
                                             <input type="text" [(ngModel)]="weSpendTokenBalanceField" name="weSpendTokenBalanceField" readonly placeholder="" />
                                        </div>
                                   </div>

                                   <!-- Offer Flags -->
                                   <div class="tab-content-container flags-container" style="min-width: 550px">
                                        <div class="flags-wrapper">
                                             <div class="token-flags-header">
                                                  <lucide-icon name="flag" size="20"></lucide-icon>
                                                  <span class="token-flags-title">Offer Flags</span>
                                             </div>

                                             <!-- tfRenew -->
                                             <div class="flag-item-account-flags" [class.enabled]="flags.passive" (click)="toggleFlag('passive')">
                                                  <div class="flag-header-account">
                                                       <input type="checkbox" id="passive" name="passive" [checked]="flags.passive" class="flag-checkbox" />
                                                       <svg class="flag-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                            <path d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0L3 7m1.582 2H12" />
                                                       </svg>
                                                       <span class="flag-title">Passive</span>
                                                  </div>
                                                  <div class="flag-value">0x00010000 tfPassive</div>
                                                  <div class="flag-desc">The offer does not consume offers that exactly match it, and instead becomes an Offer object in the ledger. It still consumes offers that cross it.</div>
                                             </div>

                                             <!-- tfClose -->
                                             <div class="flag-item-account-flags" [class.enabled]="flags.marketOrder" (click)="toggleFlag('marketOrder')">
                                                  <div class="flag-header">
                                                       <input type="checkbox" [checked]="flags.marketOrder" class="flag-checkbox" disabled />
                                                       <svg class="flag-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                            <path d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0L3 7m1.582 2H12" />
                                                       </svg>
                                                       <span class="flag-title">Immediate Or Cancel</span>
                                                  </div>
                                                  <div class="flag-value">0x00020000 tfImmediateOrCancel</div>
                                                  <div class="flag-desc">The offer never becomes a ledger object: it only tries to match existing offers in the ledger. If the offer cannot match any offers immediately, it executes "successfully" without trading any currency. In this case, the transaction has the result code tesSUCCESS, but creates no Offer objects in the ledger.</div>
                                             </div>

                                             <!-- tfClose -->
                                             <div class="flag-item-account-flags" [class.enabled]="flags.fillOrKill" (click)="toggleFlag('fillOrKill')">
                                                  <div class="flag-header">
                                                       <input type="checkbox" [checked]="flags.fillOrKill" class="flag-checkbox" disabled />
                                                       <svg class="flag-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                            <path d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0L3 7m1.582 2H12" />
                                                       </svg>
                                                       <span class="flag-title">Fill Or Kill</span>
                                                  </div>
                                                  <div class="flag-value">0x00040000 tfFillOrKill</div>
                                                  <div class="flag-desc">Only try to match existing offers in the ledger, and only do so if the entire TakerPays quantity can be obtained. If the fix1578 amendment is enabled and the offer cannot be executed when placed, the transaction has the result code tecKILLED; otherwise, the transaction uses the result code tesSUCCESS even when it was killed without trading any currency.</div>
                                             </div>

                                             <!-- TOTAL FLAGS VALUE -->
                                             <div class="flags-total">
                                                  <span class="total-label">Total Flags Value:</span>
                                                  <span class="total-value">{{ totalFlagsValue }} ({{ totalFlagsHex }})</span>
                                             </div>
                                        </div>
                                   </div>
                                   }

                                   <!-- Cancel offer -->
                                   @if (activeTab === 'cancelOffer') {
                                   <div class="form-row">
                                        <div class="form-group">
                                             <label for="offerSequenceField">Offer Sequence</label>
                                             <input type="text" id="offerSequenceField" placeholder="Comma seperated list of sequence numbers" [(ngModel)]="offerSequenceField" name="offerSequenceField" />
                                             @if (existingNfts.length > 0) {
                                             <label for="nftSelect">NFT Token ID</label>
                                             <div>
                                                  <!-- <select id="nftSelect" name="nftSelect" [(ngModel)]="selectedNft" (ngModelChange)="onSelectNft($event)">
                                                       <option [ngValue]="null">Select an NFT Token ID to cancel</option>

                                                       @for (nft of existingNfts; track nft.NFTokenID) {
                                                       <option [ngValue]="nft.NFTokenID">{{ nft.NFTokenID | slice:0:20 }}... ({{ nft.URI ?? 'No URI' }})</option>
                                                       }
                                                  </select> -->
                                             </div>
                                             }
                                        </div>
                                   </div>
                                   }
                              </div>
                         </div>

                         <!-- Switches -->
                         <div class="switch-group">
                              <!-- Memo group -->
                              <label class="switch">
                                   <input type="checkbox" [(ngModel)]="isMemoEnabled" name="isMemoEnabled" />
                                   <span class="slider"></span>
                                   Add Memo
                              </label>

                              <!-- Multi Signing Enabled group -->
                              @if (multiSigningEnabled) {
                              <label class="switch">
                                   <input type="checkbox" [(ngModel)]="useMultiSign" (ngModelChange)="toggleMultiSign()" name="useMultiSign" />
                                   <span class="slider"></span>
                                   Use Multi-Sign
                              </label>
                              }

                              <!-- Regular Key Signing Enabled-->
                              @if (regularKeySigningEnabled) {
                              <label class="switch">
                                   <input type="checkbox" [(ngModel)]="isRegularKeyAddress" (ngModelChange)="toggleMultiSign()" name="isRegularKeyAddress" />
                                   <span class="slider"></span>
                                   Use Regular Key
                              </label>
                              }

                              <!-- Use Ticket for tx -->
                              @if (ticketArray.length > 0) {
                              <label class="switch">
                                   <input type="checkbox" [(ngModel)]="isTicket" name="isTicket" />
                                   <span class="slider"></span>
                                   Use Ticket
                              </label>
                              }

                              <!-- Simulate tx -->
                              <label class="switch">
                                   <input type="checkbox" [(ngModel)]="ui.isSimulateEnabled" name="isSimulateEnabled" (ngModelChange)="ui.toggleSimulate($event)" />
                                   <span class="slider"></span>
                                   Simulate
                              </label>
                         </div>

                         <!-- Memo Field -->
                         @if (isMemoEnabled) {
                         <textarea [(ngModel)]="memoField" name="memoField" placeholder="Separate multiple memos with commas" class="memo-input"></textarea>
                         }

                         <!-- Sign tx with Mult Sign address -->
                         @if (useMultiSign) {
                         <div class="multisign-grid">
                              <div class="multisign-field">
                                   <label>Signers</label>
                                   <textarea #signers [(ngModel)]="multiSignAddress" name="multiSignAddress" readonly></textarea>
                              </div>
                              <div class="multisign-field">
                                   <label>Seeds</label>
                                   <textarea #seeds [(ngModel)]="multiSignSeeds" name="multiSignSeeds" readonly></textarea>
                              </div>
                              <div class="multisign-field quorum-field">
                                   <label>Quorum</label>
                                   <input type="text" [(ngModel)]="signerQuorum" name="signerQuorumField" readonly />
                              </div>
                         </div>
                         }

                         <!-- Sign tx with Regular key address -->
                         @if (isRegularKeyAddress) {
                         <div class="regular-key-fields">
                              <div class="form-row">
                                   <div class="form-group">
                                        <label>Regular Key Address</label>
                                        <input type="text" [(ngModel)]="regularKeyAddress" name="regularKeyAddress" readonly />
                                   </div>
                              </div>
                              <div class="form-row">
                                   <div class="form-group">
                                        <label>Regular Key Seed</label>
                                        <input type="text" [(ngModel)]="regularKeySeed" name="regularKeySeed" readonly />
                                   </div>
                              </div>
                         </div>
                         }

                         <!-- Get ticket -->
                         @if (isTicket) {
                         <div class="ticket-fields">
                              <div class="form-group">
                                   <label>Ticket Sequence</label>
                                   @if (multiSelectMode) {
                                   <div>
                                        <select [(ngModel)]="selectedTickets" multiple [ngModelOptions]="{standalone: true}">
                                             @for (ticket of ticketArray; track ticket) {
                                             <option [value]="ticket">{{ ticket }}</option>
                                             }
                                        </select>
                                   </div>
                                   } @else {
                                   <div>
                                        <select [(ngModel)]="selectedSingleTicket" [ngModelOptions]="{standalone: true}">
                                             <option value="" disabled>Select a ticket</option>
                                             @for (ticket of ticketArray; track ticket) {
                                             <option [value]="ticket">{{ ticket }}</option>
                                             }
                                        </select>
                                   </div>
                                   }
                              </div>
                         </div>
                         }

                         <!-- Action buttons -->
                         <div class="button-row">
                              @if (activeTab === 'getOffers') {
                              <button type="button" class="btn-primary-blue" (click)="getOffers()" [disabled]="ui.spinner">{{ ui.spinner ? 'Processing...' : 'Get Offers' }}</button>
                              <button type="button" class="btn-primary-blue" (click)="getOrderBook()" [disabled]="ui.spinner">{{ ui.spinner ? 'Processing...' : 'Get Orderbook' }}</button>
                              <button type="button" class="btn-primary-green" (click)="createOffer()" [disabled]="ui.spinner">{{ ui.spinner ? 'Processing...' : 'Create Offer' }}</button>
                              <button type="button" class="btn-primary-green" (click)="getTokenBalance()" [disabled]="ui.spinner">{{ ui.spinner ? 'Processing...' : 'Get Token Balance' }}</button>
                              <button type="button" class="btn-primary-green" (click)="invertOrder()" [disabled]="ui.spinner">{{ ui.spinner ? 'Processing...' : 'Invert Order' }}</button>
                              } @else if(activeTab === 'cancelOffer') {
                              <button type="button" class="btn-primary-red" (click)="cancelOffer()" [disabled]="ui.spinner">{{ ui.spinner ? 'Processing...' : 'Cancel Offer' }}</button>
                              <button type="button" (click)="clearFields(true)" class="btn-secondary-clear-fields">Clear Fields</button>
                              }
                         </div>

                         <!-- Spinner -->
                         @if (ui.spinner) {
                         <div class="spinner-row">
                              <div class="spinner"></div>
                              <span>{{ ui.spinnerMessage || 'Loading...' }}</span>
                         </div>
                         }

                         <!-- Success message -->
                         @if (ui.isSuccess && !ui.isError) {
                         <div class="success-message">
                              <lucide-icon name="check" size="20"></lucide-icon>
                              <div class="success-text">
                                   @if (ui.txHash && !ui.isSimulateEnabled) {
                                   <span>{{ui.successMessage}}</span><br /><br />
                                   <span>Transaction hash: <a [href]="`${url}tx/` + ui.txHash" target="_blank" rel="noopener noreferrer" class="tx-hash-link"> {{ ui.txHash }} </a></span>
                                   } @else {
                                   <span>{{ui.successMessage}}</span>
                                   }

                                   <!-- Multiple Hashes -->
                                   @if (ui.txHashes.length > 1 && !ui.isSimulateEnabled) {
                                   <div class="tx-hashes">
                                        @for (hash of ui.txHashes; track hash; let i = $index) {
                                        <div class="tx-hash-item">
                                             Transaction {{ i + 1 }} hash:
                                             <a [href]="url + 'tx/' + hash" target="_blank" rel="noopener noreferrer" class="tx-hash-link"> {{ hash }} </a>
                                        </div>
                                        }
                                   </div>
                                   }

                                   <!-- Single hash -->
                                   @if (ui.txHashes.length === 1 && !ui.isSimulateEnabled) {
                                   <span>Transaction hash: <a [href]="url + 'tx/' + ui.txHashes[0]" target="_blank" rel="noopener noreferrer" class="tx-hash-link"> {{ ui.txHashes[0] }} </a></span>
                                   }
                              </div>
                         </div>
                         }

                         <!-- Error message -->
                         @if (ui.isError && ui.result) {
                         <div class="tx-message error">
                              <ng-icon name="heroExclamationCircle" size="20" class="text-red-600"></ng-icon>
                              <div class="tx-text">
                                   <!-- Display Tx Hash if we are not in simulation mode-->
                                   @if (ui.txHash && !ui.isSimulateEnabled) {
                                   <span>{{ ui.result }}</span><br />
                                   <span>Transaction hash: <a [href]="`${url}tx/` + ui.txHash" target="_blank" rel="noopener noreferrer" class="tx-hash-link"> {{ ui.txHash }} </a></span>
                                   } @else {
                                   <span>{{ ui.result }}</span>
                                   }
                              </div>
                         </div>
                         }
                    </div>
               </form>

               <!-- Tx Preview -->
               @if (ui.paymentTx.length >0) {
               <div class="tx-preview-container">
                    <div class="tx-header">
                         <h5 class="tx-title">Payment Transaction</h5>
                         <div class="tx-actions">
                              <button class="copy-btn" (click)="copyUtilService.copyTx()" title="Copy JSON">
                                   <ng-icon name="heroClipboardDocumentList" size="20" class="text-red-600"></ng-icon>
                                   Copy
                              </button>
                              <button class="download-btn" (click)="downloadUtilService.downloadTx()" title="Download JSON">
                                   <ng-icon name="heroArrowDownOnSquareStack" size="20" class="text-red-600"></ng-icon>
                                   Download
                              </button>
                         </div>
                    </div>

                    <pre class="tx-json language-json"><code #paymentJson class="language-json"></code></pre>
               </div>
               }

               <!-- Tx Result Preview -->
               @if (ui.txResult.length >0) {
               <div class="tx-preview-container">
                    <div class="tx-header">
                         <h3 class="tx-title">Transaction Result</h3>
                         <div class="tx-actions">
                              <button class="copy-btn" (click)="copyUtilService.copyTxResult()" title="Copy JSON">
                                   <ng-icon name="heroClipboardDocumentList" size="20" class="text-red-600"></ng-icon>
                                   Copy
                              </button>
                              <button class="download-btn" (click)="downloadUtilService.downloadTxResult()" title="Download JSON">
                                   <ng-icon name="heroArrowDownOnSquareStack" size="20" class="text-red-600"></ng-icon>
                                   Download
                              </button>
                         </div>
                    </div>

                    <pre class="tx-json language-json"><code #txResultJson class="language-json"></code></pre>
               </div>
               }
          </div>
     </div>
</div>

<!-- 


                         <tr style="vertical-align: top">
                              <td colspan="2">
                                   <button type="button" (click)="getOffers()">Get Offers</button>
                                   <button type="button" (click)="getOrderBook()">Get Order Book</button>
                                   <button type="button" (click)="getTokenBalance()">Get Token Balance</button>
                                   <button type="button" (click)="invertOrder()">Invert Order</button>
                                   <button type="button" (click)="createOffer()">Create Offer</button>
                                   <button type="button" (click)="cancelOffer()">Cancel Offer</button>
                                   <button type="button" (click)="clearFields(true)">Clear Fields</button>
                              </td>
                         </tr>
 -->
